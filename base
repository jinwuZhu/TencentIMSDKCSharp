==H
I2lmbmRlZiBDRklMRU1NQVBfSF8KI2RlZmluZSBDRklMRU1NQVBfSF8KCiNpZmRlZiBfV0lOMzIKI2luY2x1ZGUgPFdpbmRvd3MuaD4KI2luY2x1ZGUgPHdjaGFyLmg+CiNlbHNlIAovL19fQVBQTEVfXwovL19saW51eF8KI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzeXMvc3RhdC5oPgojaW5jbHVkZSA8c3lzL21tYW4uaD4KI2VuZGlmIC8vIF9XSU4zMl8KI2luY2x1ZGUgPGNzdGRpbnQ+CiNpbmNsdWRlIDxzdHJpbmc+CgpjbGFzcyBDRmlsZU1lbW9yeU1hcAp7CnB1YmxpYzoKCWVudW0gY2xhc3MgQ0ZpbGVNZW1vcnlNYXBNb2RlIHsKCQlDRmlsZU1lbW9yeU1hcE1vZGVfUmVhZCwgLy/lj6ror7sKCQlDRmlsZU1lbW9yeU1hcE1vZGVfUmVhZEFuZFdyaXRlIC8v6K+75YaZCgl9OwpwdWJsaWM6CglDRmlsZU1lbW9yeU1hcCgpOwoJLy/liJvlu7rkuIDkuKrmlofku7bmmKDlsITvvIzmmKDlsITnm67moIfkuLrmjIflrprnmoTmlofku7blkI3np7DvvIzlpoLmnpzmiZPlvIDlpLHotKXvvIzlj6/ku6XnlKhJc09wZW7mo4DpqozmmK/lkKbmiJDlip8KCS8vQHBhcmFtIHN0ckZpbGVOYW1lIFtpbl0g5paH5Lu26Lev5b6ECgkvL0BwYXJhbSBtb2RlIFtpbl0g5pig5bCE5pa55byPIOm7mOiupOWPquivu+aWueW8j+aJk+W8gAoJQ0ZpbGVNZW1vcnlNYXAoY29uc3Qgc3RkOjpzdHJpbmcmIHN0ckZpbGVOYW1lLAoJCUNGaWxlTWVtb3J5TWFwTW9kZSBtb2RlID0gQ0ZpbGVNZW1vcnlNYXBNb2RlOjpDRmlsZU1lbW9yeU1hcE1vZGVfUmVhZCk7CgoJQ0ZpbGVNZW1vcnlNYXAoY29uc3QgQ0ZpbGVNZW1vcnlNYXAmKSA9IGRlbGV0ZTsgLy/kuI3mlK/mjIHlpI3liLbmi7fotJ3mnoTpgKAKCUNGaWxlTWVtb3J5TWFwKENGaWxlTWVtb3J5TWFwJiYgcmlnaHQpOy8vIG5vZXhjZXB0OyBDKysgMTEKCX5DRmlsZU1lbW9yeU1hcCgpOwpwdWJsaWM6CgkvL+aJk+W8gOaWh+S7tu+8jOWwhuaWh+S7tuWGheWuueS7peaYoOWwhOWIsOWGheWtmO+8jAoJLy9AcGFyYW0gc3RyRmlsZU5hbWUgW2luXSDmlofku7bot6/lvoQKCS8vQHBhcmFtIG1vZGUgW2luXSDmmKDlsITmlrnlvI8g6buY6K6k5Y+q6K+75pa55byP5omT5byACgkvL0ByZXR1cm4g5aaC5p6c5oiQ5Yqf77yM6L+U5Zue5pig5bCE55qE5oyH6ZKI77yM5Y+v5Lul6YCa6L+H6L+Z5Liq5oyH6ZKI6K6/6Zeu5paH5Lu25YaF5a65LOi/lOWbnk5VTEzlpLHotKXvvIzor7fmo4DmtYvmmK/lkKblt7Lnu4/miZPlvIDvvIzmiJbmlofku7bkuI3lj6/orr/pl64KCWNoYXIqIE9wZW4oY29uc3Qgc3RkOjpzdHJpbmcmIHN0ckZpbGVOYW1lLCBDRmlsZU1lbW9yeU1hcE1vZGUgbW9kZSA9IENGaWxlTWVtb3J5TWFwTW9kZTo6Q0ZpbGVNZW1vcnlNYXBNb2RlX1JlYWQpOwoKCS8v5YWz6Zet5paH5Lu277yM6Kej5byA5LiO5paH5Lu255qE5pig5bCECgkvL+WFs+mXreWQju+8jOWPr+S7pee7p+e7rU9wZW7miZPlvIDlj6blpJbnmoTmlofku7YKCXZvaWQgQ2xvc2UoKTsKCS8v5qOA6aqM5piv5ZCm5bey57uP5omT5byACgkvL0ByZXR1cm4g5aaC5p6c5bey57uP5omT5byA77yM6L+U5ZuedHJ1ZQoJYm9vbCBJc09wZW4oKSBjb25zdDsKCgkvLwoJLy9AcmV0dXJuIOaVsOaNruaMh+mSiAoJY2hhciogR2V0RGF0YSgpIGNvbnN0OwoJLy8KCS8vQHJldHVybiDmmKDlsITnmoTlpKflsI8KCXVpbnQ2NF90IEdldFNpemUoKSBjb25zdDsKCS8v6I635Y+W5b2T5YmN5omT5byA55qE5paH5Lu25ZCN56ewCgkvL0ByZXR1cm4g5paH5Lu25ZCNCgljb25zdCBzdGQ6OnN0cmluZyYgR2V0RmlsZU5hbWUoKSBjb25zdDsKcHJpdmF0ZToKCXZvaWQgSW5pdChjb25zdCBzdGQ6OnN0cmluZyYgY3N0ckZpbGVOYW1lLCBDRmlsZU1lbW9yeU1hcE1vZGUgbW9kZSk7CnByaXZhdGU6CglDRmlsZU1lbW9yeU1hcE1vZGUgbV9lbk1vZGU7Cglib29sIG1fYk9wZW47CgljaGFyKiBtX3BGaWxlQWRkcjsgLy8KCXVpbnQ2NF90IG1faWxGaWxlQWRkck1hcExlbjsgLy/mmKDlsITnmoTlpKflsI8KCXN0ZDo6c3RyaW5nIG1fc3RyRmlsZU5hbWU7CiNpZmRlZiBfV0lOMzIKCUhBTkRMRSBtX2hGaWxlOwoJSEFORExFIG1faE1hcHBpbmc7CiNlbHNlCglpbnQgbV9mZDsvL+aWh+S7tueahGZkCiNlbmRpZiAvLyBfV0lOMzIKfTsKCiNlbmRpZiAvLyAhQ0ZJTEVNTUFQX0hf
==C
I2luY2x1ZGUgIkNGaWxlTWVtb3J5TWFwLmgiCiNpbmNsdWRlIDxzdHJpbmc+CiNpbmNsdWRlIDx0Y2hhci5oPgojaWZkZWYgVU5JQ09ERQojaW5jbHVkZSA8bG9jYWxlPgojaW5jbHVkZSA8Y29kZWN2dD4KI2VuZGlmIC8vVU5JQ09ERQoKQ0ZpbGVNZW1vcnlNYXA6OkNGaWxlTWVtb3J5TWFwKCkKewoJc3RkOjpzdHJpbmcgc3RyRmlsZU5hbWU7CglJbml0KHN0ckZpbGVOYW1lLCBDRmlsZU1lbW9yeU1hcE1vZGU6OkNGaWxlTWVtb3J5TWFwTW9kZV9SZWFkKTsKfQoKQ0ZpbGVNZW1vcnlNYXA6OkNGaWxlTWVtb3J5TWFwKGNvbnN0IHN0ZDo6c3RyaW5nJiBzdHJGaWxlTmFtZSwgQ0ZpbGVNZW1vcnlNYXBNb2RlIG1vZGUpCnsKCUluaXQoc3RyRmlsZU5hbWUsIG1vZGUpOwp9CgpDRmlsZU1lbW9yeU1hcDo6Q0ZpbGVNZW1vcnlNYXAoQ0ZpbGVNZW1vcnlNYXAmJiByaWdodCkKewoJbV9iT3BlbiA9IHJpZ2h0Lm1fYk9wZW47CglyaWdodC5tX2JPcGVuID0gZmFsc2U7CgltX3BGaWxlQWRkciA9IHJpZ2h0Lm1fcEZpbGVBZGRyOwoJcmlnaHQubV9wRmlsZUFkZHIgPSBOVUxMOwoJbV9pbEZpbGVBZGRyTWFwTGVuID0gcmlnaHQubV9pbEZpbGVBZGRyTWFwTGVuOwoJcmlnaHQubV9pbEZpbGVBZGRyTWFwTGVuID0gMDsKCW1fc3RyRmlsZU5hbWUgPSByaWdodC5tX3N0ckZpbGVOYW1lOwoJcmlnaHQubV9zdHJGaWxlTmFtZS5jbGVhcigpOwojaWZkZWYgX1dJTjMyCgltX2hGaWxlID0gcmlnaHQubV9oRmlsZTsKCXJpZ2h0Lm1faEZpbGUgPSBJTlZBTElEX0hBTkRMRV9WQUxVRTsKCW1faE1hcHBpbmcgPSByaWdodC5tX2hNYXBwaW5nOwoJcmlnaHQubV9oTWFwcGluZyA9IElOVkFMSURfSEFORExFX1ZBTFVFOwojZWxzZQoJbV9mZCA9IHJpZ2h0Lm1fZmQ7CglyaWdodC5tX2ZkID0gMDsKI2VuZGlmIC8vIF9XSU4zMgp9CgpDRmlsZU1lbW9yeU1hcDo6fkNGaWxlTWVtb3J5TWFwKCkgewoJQ2xvc2UoKTsKfQoKY2hhciogQ0ZpbGVNZW1vcnlNYXA6Ok9wZW4oY29uc3Qgc3RkOjpzdHJpbmcmIHN0ckZpbGVOYW1lLCBDRmlsZU1lbW9yeU1hcE1vZGUgbW9kZSkKewoJaWYgKHN0ckZpbGVOYW1lLmVtcHR5KCkpIHsKCQlyZXR1cm4gTlVMTDsKCX0KCWlmIChtX2JPcGVuKSB7CgkJcmV0dXJuIE5VTEw7Cgl9CiNpZmRlZiBfV0lOMzIKCURXT1JEIGR3U2hhcmVNb2RlID0gMDsKCURXT1JEIGZsUHJvdGVjdCA9IDA7CglEV09SRCBkd0Rlc2lyZWRBY2Nlc3MgPSAwOwoJc3dpdGNoIChtb2RlKQoJewoJY2FzZSBDRmlsZU1lbW9yeU1hcDo6Q0ZpbGVNZW1vcnlNYXBNb2RlOjpDRmlsZU1lbW9yeU1hcE1vZGVfUmVhZDoKCXsKCQlkd1NoYXJlTW9kZSA9IEZJTEVfU0hBUkVfUkVBRDsKCQlmbFByb3RlY3QgPSBQQUdFX1JFQURPTkxZOwoJCWR3RGVzaXJlZEFjY2VzcyA9IEZJTEVfTUFQX1JFQUQ7Cgl9YnJlYWs7CgljYXNlIENGaWxlTWVtb3J5TWFwOjpDRmlsZU1lbW9yeU1hcE1vZGU6OkNGaWxlTWVtb3J5TWFwTW9kZV9SZWFkQW5kV3JpdGU6Cgl7CgoJCWR3U2hhcmVNb2RlID0gRklMRV9TSEFSRV9SRUFEIHwgRklMRV9TSEFSRV9XUklURTsKCQlmbFByb3RlY3QgPSBQQUdFX1JFQURXUklURTsKCQlkd0Rlc2lyZWRBY2Nlc3MgPSBGSUxFX01BUF9SRUFEIHwgRklMRV9NQVBfV1JJVEU7Cgl9YnJlYWs7CglkZWZhdWx0OgoJCWJyZWFrOwoJfQojaWZkZWYgVU5JQ09ERQoJc3RkOjp3c3RyaW5nX2NvbnZlcnQ8c3RkOjpjb2RlY3Z0X3V0Zjg8d2NoYXJfdD4sIHdjaGFyX3Q+IGNvbnZlcnRlcjsKCXN0ZDo6d3N0cmluZyB3c3RyRmlsZU5hbWUgPSBjb252ZXJ0ZXIuZnJvbV9ieXRlcyhzdHJGaWxlTmFtZSk7CglzdHJ1Y3QgX3N0YXQ2NCBzdFN0YXQ7CglpZiAoMCAhPSBfdHN0YXQ2NCh3c3RyRmlsZU5hbWUuY19zdHIoKSwgJnN0U3RhdCkpCgl7CgkJcmV0dXJuIE5VTEw7Cgl9CglMQVJHRV9JTlRFR0VSIHN0TEkgPSB7IDAgfTsKCXN0TEkuUXVhZFBhcnQgPSBzdFN0YXQuc3Rfc2l6ZTsKCW1faEZpbGUgPSBDcmVhdGVGaWxlKHdzdHJGaWxlTmFtZS5jX3N0cigpLCBHRU5FUklDX1JFQUQsIGR3U2hhcmVNb2RlLCBOVUxMLCBPUEVOX0VYSVNUSU5HLCBGSUxFX0FUVFJJQlVURV9OT1JNQUwsIE5VTEwpOwoJaWYgKG1faEZpbGUgPT0gSU5WQUxJRF9IQU5ETEVfVkFMVUUpCgl7CgkJcmV0dXJuIE5VTEw7Cgl9CiNlbHNlCglzdHJ1Y3QgX3N0YXQ2NCBzdFN0YXQ7CglpZiAoMCAhPSBfdHN0YXQ2NChzdHJGaWxlTmFtZS5jX3N0cigpLCAmc3RTdGF0KSkKCXsKCQlyZXR1cm4gTlVMTDsKCX0KCUxBUkdFX0lOVEVHRVIgc3RMSSA9IHsgMCB9OwoJc3RMSS5RdWFkUGFydCA9IHN0U3RhdC5zdF9zaXplOwoJbV9oRmlsZSA9IENyZWF0ZUZpbGUoc3RyRmlsZU5hbWUuY19zdHIoKSwgR0VORVJJQ19SRUFELCBkd1NoYXJlTW9kZSwgTlVMTCwgT1BFTl9FWElTVElORywgRklMRV9BVFRSSUJVVEVfTk9STUFMLCBOVUxMKTsKCWlmIChtX2hGaWxlID09IElOVkFMSURfSEFORExFX1ZBTFVFKQoJewoJCXJldHVybiBOVUxMOwoJfQojZW5kaWYgLy8gVU5JQ09ERQoKCW1faE1hcHBpbmcgPSBDcmVhdGVGaWxlTWFwcGluZyhtX2hGaWxlLCBOVUxMLCBmbFByb3RlY3QsIHN0TEkuSGlnaFBhcnQsIHN0TEkuTG93UGFydCwgTlVMTCk7CglpZiAobV9oTWFwcGluZyA9PSBOVUxMKQoJewoJCUNsb3NlSGFuZGxlKG1faEZpbGUpOwoJCW1faEZpbGUgPSBJTlZBTElEX0hBTkRMRV9WQUxVRTsKCQlyZXR1cm4gTlVMTDsKCX0KCW1fcEZpbGVBZGRyID0gKGNoYXIqKU1hcFZpZXdPZkZpbGUobV9oTWFwcGluZywgZHdEZXNpcmVkQWNjZXNzLCAwLCAwLCBzdExJLlF1YWRQYXJ0KTsKCWlmIChudWxscHRyID09IG1fcEZpbGVBZGRyKQoJewoJCUNsb3NlSGFuZGxlKG1faE1hcHBpbmcpOwoJCW1faE1hcHBpbmcgPSBJTlZBTElEX0hBTkRMRV9WQUxVRTsKCQlDbG9zZUhhbmRsZShtX2hGaWxlKTsKCQltX2hGaWxlID0gSU5WQUxJRF9IQU5ETEVfVkFMVUU7CgkJcmV0dXJuIE5VTEw7Cgl9CgltX2lsRmlsZUFkZHJNYXBMZW4gPSBzdFN0YXQuc3Rfc2l6ZTsKCW1fYk9wZW4gPSB0cnVlOwojZWxzZQoJdWludDY0X3QgaWxGaWxlU2l6ZSA9IDA7CglzdHJ1Y3Qgc3RhdCBzdGF0YnVmOwoJaWYgKHN0YXQoc3RyRmlsZU5hbWUuY19zdHIoKSwgJnN0YXRidWYpID09IDApCgl7CgkJaWxGaWxlU2l6ZSA9IHN0YXRidWYuc3Rfc2l6ZTsKCX0KCWVsc2UKCXsKCQlyZXR1cm4gTlVMTDsKCX0KCXN0ZDo6c3RyaW5nIHN0clJlYWRNb2RlOwoJc3dpdGNoIChtb2RlKQoJewoJY2FzZSBDRmlsZU1lbW9yeU1hcDo6Q0ZpbGVNZW1vcnlNYXBNb2RlOjpDRmlsZU1lbW9yeU1hcE1vZGVfUmVhZDoKCXsKCQlzdHJSZWFkTW9kZSA9ICJyYiI7Cgl9YnJlYWs7CgljYXNlIENGaWxlTWVtb3J5TWFwOjpDRmlsZU1lbW9yeU1hcE1vZGU6OkNGaWxlTWVtb3J5TWFwTW9kZV9SZWFkQW5kV3JpdGU6Cgl7CgkJc3RyUmVhZE1vZGUgPSAid2IrIjsKCX1icmVhazsKCWRlZmF1bHQ6Cgl7CgkJcmV0dXJuIE5VTEw7Cgl9YnJlYWs7Cgl9CiNpZmRlZiBVTklDT0RFCgl1c2luZyBjb252ZXJ0VHlwZSA9IHN0ZDo6Y29kZWN2dF91dGY4PHdjaGFyX3Q+CgkJc3RkOjp3c3RyaW5nX2NvbnZlcnQ8Y29udmVydFR5cGUsIHdjaGFyX3Q+IGNvbnZlcnRlcjsKCXN0ZDo6c3RyaW5nIHN0clV0ZjhGaWxlTmFtZSA9IGNvbnZlcnRlci50b19ieXRlcyhzdHJGaWxlTmFtZSk7CgltX2ZkID0gZm9wZW4oc3RyVXRmOEZpbGVOYW1lLmNfc3RyKCksIHN0clJlYWRNb2RlLmNfc3RyKCkpOwojZWxzZQoJbV9mZCA9IGZvcGVuKHN0ckZpbGVOYW1lLmNfc3RyKCksIHN0clJlYWRNb2RlLmNfc3RyKCkpOwojZW5kaWYgLy9VTklDT0RFCglpZiAobV9mZCA8PSAwKQoJewoJCXJldHVybiBOVUxMOwoJfQoJbV9wRmlsZUFkZHIgPSAoY2hhciopbW1hcCgwLCBpbEZpbGVTaXplLCBQUk9UX1JFQUQsIE1BUF9TSEFSRUQsIG1fZmQsIDApOwoJaWYgKG1fcEZpbGVBZGRyID09IE5VTEwpCgl7CgkJbV9iT3BlbiA9IHRydWU7CgkJZmNsb3NlKG1fZmQpOwoJCXJldHVybiBOVUxMOwoJfQoJbV9pbEZpbGVBZGRyTWFwTGVuID0gaWxGaWxlU2l6ZTsKI2VuZGlmIC8vIF9XSU4zMgoKCW1fc3RyRmlsZU5hbWUgPSBzdHJGaWxlTmFtZTsKCW1fZW5Nb2RlID0gbW9kZTsKCglyZXR1cm4gbV9wRmlsZUFkZHI7Cn0Kdm9pZCBDRmlsZU1lbW9yeU1hcDo6Q2xvc2UoKQp7CglpZiAobV9iT3BlbikgewojaWZkZWYgX1dJTjMyCgkJaWYgKG1fcEZpbGVBZGRyKQoJCXsKCQkJVW5tYXBWaWV3T2ZGaWxlKG1fcEZpbGVBZGRyKTsKCQl9CgkJaWYgKG1faE1hcHBpbmcgIT0gSU5WQUxJRF9IQU5ETEVfVkFMVUUpCgkJewoJCQlDbG9zZUhhbmRsZShtX2hNYXBwaW5nKTsKCQkJbV9oTWFwcGluZyA9IElOVkFMSURfSEFORExFX1ZBTFVFOwoJCX0KCQlpZiAobV9oRmlsZSAhPSBJTlZBTElEX0hBTkRMRV9WQUxVRSkKCQl7CgkJCUNsb3NlSGFuZGxlKG1faEZpbGUpOwoJCQltX2hGaWxlID0gSU5WQUxJRF9IQU5ETEVfVkFMVUU7CgkJfQojZWxzZSAKCQlpZiAobV9wRmlsZUFkZHIpCgkJewoJCQltdW5tYXAobV9wRmlsZUFkZHIsIG1faWxGaWxlQWRkck1hcExlbik7CgkJfQoJCWlmIChtX2ZkKQoJCXsKCQkJZmNsb3NlKG1fZmQpOwoJCQltX2ZkID0gMDsKCQl9CiNlbmRpZiAvLyBfV0lOMzJfCgkJbV9wRmlsZUFkZHIgPSBOVUxMOwoJCW1faWxGaWxlQWRkck1hcExlbiA9IDA7CgkJbV9zdHJGaWxlTmFtZS5jbGVhcigpOwoJCW1fYk9wZW4gPSBmYWxzZTsKCX0KfQpib29sIENGaWxlTWVtb3J5TWFwOjpJc09wZW4oKSBjb25zdAp7CglyZXR1cm4gbV9iT3BlbjsKfQpjaGFyKiBDRmlsZU1lbW9yeU1hcDo6R2V0RGF0YSgpIGNvbnN0CnsKCXJldHVybiBtX3BGaWxlQWRkcjsKfQp1aW50NjRfdCBDRmlsZU1lbW9yeU1hcDo6R2V0U2l6ZSgpIGNvbnN0CnsKCXJldHVybiBtX2lsRmlsZUFkZHJNYXBMZW47Cn0KY29uc3Qgc3RkOjpzdHJpbmcmIENGaWxlTWVtb3J5TWFwOjpHZXRGaWxlTmFtZSgpIGNvbnN0CnsKCXJldHVybiBtX3N0ckZpbGVOYW1lOwp9CnZvaWQgQ0ZpbGVNZW1vcnlNYXA6OkluaXQoY29uc3Qgc3RkOjpzdHJpbmcmIHN0ckZpbGVOYW1lLCBDRmlsZU1lbW9yeU1hcE1vZGUgbW9kZSkKewoJbV9pbEZpbGVBZGRyTWFwTGVuID0gMDsKCW1fYk9wZW4gPSBmYWxzZTsKCW1fcEZpbGVBZGRyID0gTlVMTDsKI2lmZGVmIF9XSU4zMgoJbV9oRmlsZSA9IElOVkFMSURfSEFORExFX1ZBTFVFOwoJbV9oTWFwcGluZyA9IElOVkFMSURfSEFORExFX1ZBTFVFOwojZWxzZQoJbV9mZCA9IC0xOy8v5paH5Lu255qEZmQKI2VuZGlmIC8vIF9XSU4zMgoJT3BlbihzdHJGaWxlTmFtZSwgbW9kZSk7Cn0=
==M
I2luY2x1ZGUgPGlvc3RyZWFtPgojaW5jbHVkZSA8c3RyaW5nPgojaW5jbHVkZSA8ZnN0cmVhbT4KI2luY2x1ZGUgPHZlY3Rvcj4KZXh0ZXJuICJDIiB7CiNpbmNsdWRlIDxsaWJhdmZvcm1hdC9hdmZvcm1hdC5oPgojaW5jbHVkZSA8bGliYXZ1dGlsL2F2dXRpbC5oPgojaW5jbHVkZSA8bGliYXZjb2RlYy9hdmNvZGVjLmg+Cn0KI2luY2x1ZGUgIkNGaWxlTWVtb3J5TWFwLmgiCiNpbmNsdWRlIDxzZXQ+Ci8v6I635Y+WIEgyNjTnvJbnoIFOQUznmoTljZXlhYPnsbvlnovvvIhVSU5UVFlQRe+8ieWNleWFg+exu+Wei+iMg+WbtOS4ujF+MjMg5qCH5YeG5Li6IDF+MTIKI2RlZmluZSBOQUxfVUlOVFRZUEUobmFsKSAoKG5hbCkmKDB4MUYpKQovL+iOt+WPliBIMjY057yW56CBTkFM55qE5LyY5YWI57qn77yIUkVGRVJFTkNFX0JJVO+8iQojZGVmaW5lIE5BTF9SRUZFUkVOQ0UobmFsKSAoKG5hbCkmKDB4NjApKQovL+iOt+WPliBIMjY057yW56CBTkFM55qE56aB5q2i5L2N77yIZm9yYmlkZGVyX2JpdO+8iQojZGVmaW5lIE5BTF9GT1JCSURERVIobmFsKSAoKG5hbCkmKDB4ODApKQp1c2luZyBOQUwgPSB1aW50OF90OwoKdWludDMyX3QgU3dhcEludDMyRGF0YSh1aW50MzJfdCBuVmFsdWVEYXRhKQp7CglyZXR1cm4gKChuVmFsdWVEYXRhICYgMHgwMDAwMDBGRikgPDwgMjQpIHwKCQkoKG5WYWx1ZURhdGEgJiAweDAwMDBGRjAwKSA8PCA4KSB8CgkJKChuVmFsdWVEYXRhICYgMHgwMEZGMDAwMCkgPj4gOCkgfAoJCSgoblZhbHVlRGF0YSAmIDB4RkYwMDAwMDApID4+IDI0KTsKfQoKdm9pZCBDb3B5RmlsZVN0cmVhbShzdGQ6Omlmc3RyZWFtJiBpbiwgc3RkOjpvZnN0cmVhbSYgb3V0LCBpbnQ2NF90IGxlbikgewoKCWNoYXIgYnVmWzEwMjRdOwoJaW50NjRfdCBjb3B5U2l6ZSA9IGxlbjsKCXdoaWxlIChjb3B5U2l6ZSA+IDApCgl7CgkJaW50NjRfdCByZWFkU2l6ZTsKCQlpZiAoY29weVNpemUgPCBzaXplb2YoYnVmKSkgewoJCQlyZWFkU2l6ZSA9IGNvcHlTaXplOwoJCX0KCQllbHNlIHsKCQkJcmVhZFNpemUgPSBzaXplb2YoYnVmKTsKCQl9CgkJaW4ucmVhZChidWYsIHJlYWRTaXplKTsKCQlvdXQud3JpdGUoYnVmLCByZWFkU2l6ZSk7CgkJY29weVNpemUgLT0gcmVhZFNpemU7Cgl9Cn0KCgppbnQgVGVzdCgpIHsKCgkvL3N0ZDo6c3RyaW5nIGlucHV0RmlsZU5hbWUgPSAiRDpcXHdvcmtcXEMwMDUyLVJlcGFpcjItMjA5MjA5MjhfMTEwMDUxLmgyNjQiOwoJc3RkOjpzZXQ8dWludDMyX3Q+IGF1ZGlvSGVhZHM7CglpbnQgYWRGcmFtZUNvdW50ID0gMDsKCXN0ZDo6c3RyaW5nIGlucHV0RmlsZU5hbWUgPSAiRDpcXOWOn+inhumikVxcNTMubXA0IjsKCXN0ZDo6c3RyaW5nIG91dHB1dEZpbGVOYW1lID0gaW5wdXRGaWxlTmFtZSArICJfZHVtcC5kYXRhIjsKCXN0ZDo6b2ZzdHJlYW0gb3V0cHV0RmlsZVN0cmVhbShvdXRwdXRGaWxlTmFtZSwgc3RkOjppb3M6OmJpbmFyeSB8IHN0ZDo6aW9zOjpvdXQpOwoJaWYgKG91dHB1dEZpbGVTdHJlYW0uaXNfb3BlbigpID09IGZhbHNlKSB7CgkJYXZfbG9nKE5VTEwsIEFWX0xPR19XQVJOSU5HLCAib3BlbiBvdXRwdXQgZmlsZSBmYWlsZWQhIVxuIik7CgkJcmV0dXJuIC0xOwoJfQoJQVZGb3JtYXRDb250ZXh0KiBmbXRDdHggPSBOVUxMOwoJaW50IHJldCA9IGF2Zm9ybWF0X29wZW5faW5wdXQoJmZtdEN0eCwgaW5wdXRGaWxlTmFtZS5jX3N0cigpLCBOVUxMLCBOVUxMKTsKCWlmIChyZXQgIT0gMCkgewoJCWF2X2xvZyhOVUxMLCBBVl9MT0dfV0FSTklORywgIm9wZW4gaW5wdXQgZmlsZSBmYWlsZWQhIVxuIik7CgkJcmV0dXJuIC0xOwoJfQoJYXZfZHVtcF9mb3JtYXQoZm10Q3R4LCAwLCBOVUxMLCAwKTsKCWludCB2aWRlb1N0cmVhbUlkID0gLTE7Cglmb3IgKHNpemVfdCBpID0gMDsgaSA8IGZtdEN0eC0+bmJfc3RyZWFtczsgaSsrKQoJewoJCWlmIChmbXRDdHgtPnN0cmVhbXNbaV0tPmNvZGVjcGFyLT5jb2RlY190eXBlID09IEFWTUVESUFfVFlQRV9WSURFTykgewoJCQl2aWRlb1N0cmVhbUlkID0gaTsKCQkJYnJlYWs7CgkJfQoJfQoJaWYgKHZpZGVvU3RyZWFtSWQgPCAwKSB7CgkJYXZfbG9nKE5VTEwsIEFWX0xPR19XQVJOSU5HLCAidmlkZW8gc3RyZWFtIG5vdCBleHRpcyIpOwoJCWF2Zm9ybWF0X2Nsb3NlX2lucHV0KCZmbXRDdHgpOwoJCXJldHVybiAtMTsKCX0KCglvdXRwdXRGaWxlU3RyZWFtLndyaXRlKChjaGFyKikoZm10Q3R4LT5zdHJlYW1zW3ZpZGVvU3RyZWFtSWRdLT5jb2RlY3Bhci0+ZXh0cmFkYXRhKSwgZm10Q3R4LT5zdHJlYW1zW3ZpZGVvU3RyZWFtSWRdLT5jb2RlY3Bhci0+ZXh0cmFkYXRhX3NpemUpOwoJb3V0cHV0RmlsZVN0cmVhbS53cml0ZSgiICAgICIsIDQpOwoJQVZQYWNrZXQgcGt0OwoJYXZfaW5pdF9wYWNrZXQoJnBrdCk7CglpbnQ2NF90IGR1bXBTaXplID0gMDsKCXdoaWxlICh0cnVlKQoJewoJCWF2X2luaXRfcGFja2V0KCZwa3QpOwoJCXJldCA9IGF2X3JlYWRfZnJhbWUoZm10Q3R4LCAmcGt0KTsKCQlpZiAocmV0ICE9IDApIHsKCQkJYXZfcGFja2V0X3VucmVmKCZwa3QpOwoJCQlicmVhazsKCgkJfQoJCXN0ZDo6c3RyaW5nIG1zZzsKCQlpZiAocGt0LnN0cmVhbV9pbmRleCA9PSB2aWRlb1N0cmVhbUlkKQoJCXsKCQkJbXNnID0gc3RkOjpzdHJpbmcoIiNWRCIpICsgc3RkOjp0b19zdHJpbmcocGt0LnNpemUpICsgc3RkOjpzdHJpbmcoIlZEIyIpOwoJCX0KCQllbHNlCgkJewoJCQlhdWRpb0hlYWRzLmluc2VydCgqKCh1aW50MzJfdCopcGt0LmRhdGEpKTsKCQkJYWRGcmFtZUNvdW50Kys7CgkJCW1zZyA9IHN0ZDo6c3RyaW5nKCIjQUQiKSArIHN0ZDo6dG9fc3RyaW5nKHBrdC5zaXplKSArIHN0ZDo6c3RyaW5nKCJBRCMiKTsKCQl9CgoJCXByaW50ZigiJXNcbiIsIG1zZy5jX3N0cigpKTsKCQlvdXRwdXRGaWxlU3RyZWFtLndyaXRlKG1zZy5jX3N0cigpLCBtc2cubGVuZ3RoKCkpOwoJCW91dHB1dEZpbGVTdHJlYW0ud3JpdGUoKGNoYXIqKXBrdC5kYXRhLCBwa3Quc2l6ZSk7CgkJLyoKCQlkbwoJCXsKCQkJdWludDMyX3QgY2h1Y2tTaXplID0gKigodWludDMyX3QqKSYocGt0LmRhdGFbaV0pKTsKCQkJY2h1Y2tTaXplID0gU3dhcEludDMyRGF0YShjaHVja1NpemUpOwoJCQkvL2NoYXIgbmFsaFtdID0geyAweDAwLDB4MDAsMHgwMCwweDAxIH07CgkJCS8vb3V0cHV0RmlsZVN0cmVhbS53cml0ZShuYWxoLCBzaXplb2YobmFsaCkpOwoJCQlvdXRwdXRGaWxlU3RyZWFtLndyaXRlKChjaGFyKikoJihwa3QuZGF0YVtpICsgNF0pKSwgY2h1Y2tTaXplKTsKCQkJaSArPSAoY2h1Y2tTaXplICsgNCk7CgkJfSB3aGlsZSAoaSA8IHBrdC5zaXplKTsKCQkqLwoJfQoJcHJpbnRmKCJbSENPVU5ULyBGQ09VTlQgXSAlZCAvJWQiLCAoaW50KWF1ZGlvSGVhZHMuc2l6ZSgpLCBhZEZyYW1lQ291bnQpOwoJYXZmb3JtYXRfY2xvc2VfaW5wdXQoJmZtdEN0eCk7CglyZXR1cm4gMDsKfQoKaW50IE1lbW9yeUFWSU9SZWFkKHZvaWQqIG9wYXF1ZSwgdWludDhfdCogYnVmLCBpbnQgYnVmX3NpemUpIHsKCXZvaWQqKiBwYXJhbXMgPSAodm9pZCoqKW9wYXF1ZTsKCS8vQ0ZpbGVNZW1vcnlNYXAqIHBjbEZpbGVNYXAgPSAoQ0ZpbGVNZW1vcnlNYXAqKXBhcmFtc1swXTsKCXVpbnQ4X3QqIHBEYXRhID0gKHVpbnQ4X3QqKShwYXJhbXNbMF0pOwoJaW50NjRfdCYgaWxDdXJyZW50T2Zmc2V0ID0gKigoaW50NjRfdCopcGFyYW1zWzFdKTsKCWludDY0X3QgaWxTdGFydE9mZnNldCA9ICooKGludDY0X3QqKXBhcmFtc1syXSk7CglpbnQ2NF90IGlsRW5kT2Zmc2V0ID0gKigoaW50NjRfdCopcGFyYW1zWzNdKTsKCWludCBpUmVhZFNpemUgPSAoaW50KXN0ZDo6bWluPGludDY0X3Q+KGlsRW5kT2Zmc2V0IC0gaWxDdXJyZW50T2Zmc2V0LCBidWZfc2l6ZSk7CglpZiAoaVJlYWRTaXplIDw9IDApIHsKCQlyZXR1cm4gRU9GOwoJfQoJbWVtY3B5KGJ1ZiwgcERhdGEgKyBpbEN1cnJlbnRPZmZzZXQsIGlSZWFkU2l6ZSk7CglpbEN1cnJlbnRPZmZzZXQgKz0gaVJlYWRTaXplOwoJcmV0dXJuIGlSZWFkU2l6ZTsKfQoKaW50NjRfdCBNZW1vcnlBVklPU2Vlayh2b2lkKiBvcGFxdWUsIGludDY0X3Qgb2Zmc2V0LCBpbnQgd2hlbmNlKSB7Cgl2b2lkKiogcGFyYW1zID0gKHZvaWQqKilvcGFxdWU7CgkvL0NGaWxlTWVtb3J5TWFwKiBwY2xGaWxlTWFwID0gKENGaWxlTWVtb3J5TWFwKilwYXJhbXNbMF07Cgl1aW50OF90KiBwRGF0YSA9ICh1aW50OF90KikocGFyYW1zWzBdKTsKCWludDY0X3QmIGlsQ3VycmVudE9mZnNldCA9ICooKGludDY0X3QqKXBhcmFtc1sxXSk7CglpbnQ2NF90IGlsU3RhcnRPZmZzZXQgPSAqKChpbnQ2NF90KilwYXJhbXNbMl0pOwoJaW50NjRfdCBpbEVuZE9mZnNldCA9ICooKGludDY0X3QqKXBhcmFtc1szXSk7CglpbnQ2NF90IGlsTmV4dE9mZnNldCA9IDA7Cglzd2l0Y2ggKHdoZW5jZSkKCXsKCWNhc2UgU0VFS19TRVQ6IAoJewoJCWlsTmV4dE9mZnNldCA9IG9mZnNldDsKCX1icmVhazsKCWNhc2UgU0VFS19DVVI6Cgl7CgkJaWxOZXh0T2Zmc2V0ID0gaWxDdXJyZW50T2Zmc2V0ICsgb2Zmc2V0OwoJfWJyZWFrOwoJY2FzZSBTRUVLX0VORDoKCXsKCQlpbE5leHRPZmZzZXQgPSBpbEVuZE9mZnNldCArIG9mZnNldDsKCX1icmVhazsKCWNhc2UgQVZTRUVLX1NJWkU6Cgl7CgkJcmV0dXJuIGlsRW5kT2Zmc2V0IC0gaWxTdGFydE9mZnNldDsKCX1icmVhazsKCWRlZmF1bHQ6Cgl7CgkJcmV0dXJuIC0xOwoJfWJyZWFrOwoJfQoJaWYgKGlsTmV4dE9mZnNldCA+IGlsRW5kT2Zmc2V0IHx8IGlsTmV4dE9mZnNldCA8PSBpbFN0YXJ0T2Zmc2V0KSB7CgkJcmV0dXJuIC0xOwoJfQoJaWxDdXJyZW50T2Zmc2V0ID0gaWxOZXh0T2Zmc2V0OwoJcmV0dXJuIDA7Cn0KaW50IFRlc3QyKCkgewoKCXN0ZDo6c3RyaW5nIGlucHV0RmlsZU5hbWUgPSAiRDpcXOWOn+inhumikVxcNTMubXA0IjsKCS8v5Yib5bu6SU/lr7nosaEKCUNGaWxlTWVtb3J5TWFwIGNsRmlsZU1hcChpbnB1dEZpbGVOYW1lLCBDRmlsZU1lbW9yeU1hcDo6Q0ZpbGVNZW1vcnlNYXBNb2RlOjpDRmlsZU1lbW9yeU1hcE1vZGVfUmVhZCk7CglpZiAoIWNsRmlsZU1hcC5Jc09wZW4oKSkgewoJCXJldHVybiAwOwoJfQoJaW50NjRfdCBpbEN1cnJlbnRPZmZzZXQgPSAwOwoJaW50NjRfdCBpbFN0YXJ0T2Zmc2V0ID0gMDsKCWludDY0X3QgaWxFbmRPZmZzZXQgPSBjbEZpbGVNYXAuR2V0U2l6ZSgpOwoJdm9pZCogcGFyYW1zWzRdID0geyBjbEZpbGVNYXAuR2V0RGF0YSgpICwmaWxDdXJyZW50T2Zmc2V0LCZpbFN0YXJ0T2Zmc2V0LCZpbEVuZE9mZnNldCB9OwoKCUFWRm9ybWF0Q29udGV4dCogaWMgPSBOVUxMOwoJaWMgPSBhdmZvcm1hdF9hbGxvY19jb250ZXh0KCk7Cgl1bnNpZ25lZCBjaGFyKiBpb2J1ZmZlciA9ICh1bnNpZ25lZCBjaGFyKilhdl9tYWxsb2MoMzI3NjgpOwoJQVZJT0NvbnRleHQqIGF2aW8gPSBhdmlvX2FsbG9jX2NvbnRleHQoaW9idWZmZXIsIDMyNzY4LCAwLCBwYXJhbXMsIE1lbW9yeUFWSU9SZWFkLCBOVUxMLCBOVUxMKTsKCWljLT5wYiA9IGF2aW87CglpbnQgZXJyID0gYXZmb3JtYXRfb3Blbl9pbnB1dCgmaWMsICJub3RoaW5nIiwgTlVMTCwgTlVMTCk7CglwcmludGYoImF2aW8gJXAgZXJyICVkIiwgYXZpbywgZXJyKTsKCXJldHVybiAwOwp9CmludCBtYWluKCkgewoJc3RkOjpzdHJpbmcgaW5wdXRGaWxlTmFtZSA9ICJEOlxc5Y6f6KeG6aKRXFw1My5tcDQiOwoJLy/liJvlu7pJT+WvueixoQoJCglDRmlsZU1lbW9yeU1hcCBjbEZpbGVNYXAoaW5wdXRGaWxlTmFtZSwgQ0ZpbGVNZW1vcnlNYXA6OkNGaWxlTWVtb3J5TWFwTW9kZTo6Q0ZpbGVNZW1vcnlNYXBNb2RlX1JlYWQpOwoJaWYgKCFjbEZpbGVNYXAuSXNPcGVuKCkpIHsKCQlyZXR1cm4gMDsKCX0KCWludDY0X3QgaWxDdXJyZW50T2Zmc2V0ID0gMDsKCWludDY0X3QgaWxTdGFydE9mZnNldCA9IDA7CglpbnQ2NF90IGlsRW5kT2Zmc2V0ID0gY2xGaWxlTWFwLkdldFNpemUoKTsKCXZvaWQqIHBhcmFtc1s0XSA9IHsgY2xGaWxlTWFwLkdldERhdGEoKSAsJmlsQ3VycmVudE9mZnNldCwmaWxTdGFydE9mZnNldCwmaWxFbmRPZmZzZXR9OwoJdW5zaWduZWQgY2hhciogcElPQnVmZmVyID0gKHVuc2lnbmVkIGNoYXIqKWF2X21hbGxvYygxMDQ4NTc2KTsvLzEwMjQqMTAyNCA9IDFNCglBVklPQ29udGV4dCogaW5wdXRDdHggPSBhdmlvX2FsbG9jX2NvbnRleHQocElPQnVmZmVyLCAxMDQ4NTc2LCAwLCBwYXJhbXMsIE1lbW9yeUFWSU9SZWFkLCBOVUxMLCBNZW1vcnlBVklPU2Vlayk7CgoJLy/nu5HlrppJT+WvueixoQoJQVZGb3JtYXRDb250ZXh0KiBmbXRDdHggPSBOVUxMOwoJZm10Q3R4ID0gYXZmb3JtYXRfYWxsb2NfY29udGV4dCgpOwoJZm10Q3R4LT5wYiA9IGlucHV0Q3R4OwoJYXZmb3JtYXRfb3Blbl9pbnB1dCgmZm10Q3R4LCBpbnB1dEZpbGVOYW1lLmNfc3RyKCksIE5VTEwsIE5VTEwpOwoJYXZfZHVtcF9mb3JtYXQoZm10Q3R4LCBOVUxMLCBOVUxMLCAwKTsKCglpbnQgdmlkZW9TdHJlYW1JZCA9IC0xOwoJZm9yIChzaXplX3QgaSA9IDA7IGkgPCBmbXRDdHgtPm5iX3N0cmVhbXM7IGkrKykKCXsKCQlpZiAoZm10Q3R4LT5zdHJlYW1zW2ldLT5jb2RlY3Bhci0+Y29kZWNfdHlwZSA9PSBBVk1FRElBX1RZUEVfVklERU8pIHsKCQkJdmlkZW9TdHJlYW1JZCA9IGk7CgkJCWJyZWFrOwoJCX0KCX0KCUFWQ29kZWMqIGRlY29kZXIgPSBhdmNvZGVjX2ZpbmRfZGVjb2RlcihmbXRDdHgtPnN0cmVhbXNbdmlkZW9TdHJlYW1JZF0tPmNvZGVjcGFyLT5jb2RlY19pZCk7CglBVkNvZGVjQ29udGV4dCogZGVjb2RlckN0eCA9IGF2Y29kZWNfYWxsb2NfY29udGV4dDMoZGVjb2Rlcik7CgkvL2F2Zm9ybWF0X29wZW5faW5wdXQoJmlucHV0Rm9ybWF0Q3R4LCAibm90aGluZyIsIE5VTEwsIE5VTEwpOwoJaW50IHJldCA9IGF2Y29kZWNfcGFyYW1ldGVyc190b19jb250ZXh0KGRlY29kZXJDdHgsIGZtdEN0eC0+c3RyZWFtc1t2aWRlb1N0cmVhbUlkXS0+Y29kZWNwYXIpOwoJcmV0ID0gYXZjb2RlY19vcGVuMihkZWNvZGVyQ3R4LCBkZWNvZGVyLCBOVUxMKTsKCUFWUGFja2V0IHBrdDsKCWF2X2luaXRfcGFja2V0KCZwa3QpOwoJc3RkOjp2ZWN0b3I8dWludDhfdD4gaDI2NERhdGFzOwoKCUFWRnJhbWUqIGZyYW1lID0gYXZfZnJhbWVfYWxsb2MoKTsKCXdoaWxlICh0cnVlKQoJewoJCWF2X2luaXRfcGFja2V0KCZwa3QpOwoJCXJldCA9IGF2X3JlYWRfZnJhbWUoZm10Q3R4LCAmcGt0KTsKCgkJaWYgKHJldCAhPSAwKSB7CgkJCXByaW50ZigiYXZfcmVhZF9mcmFtZSAlZCBcbiIsIHJldCk7CgkJCWF2X3BhY2tldF91bnJlZigmcGt0KTsKCQkJYnJlYWs7CgoJCX0KCQllbHNlIGlmIChwa3Quc3RyZWFtX2luZGV4ICE9IHZpZGVvU3RyZWFtSWQpIHsKCQkJYXZfcGFja2V0X3VucmVmKCZwa3QpOwoJCQljb250aW51ZTsKCQl9CgkJcmV0ID0gYXZjb2RlY19zZW5kX3BhY2tldChkZWNvZGVyQ3R4LCAmcGt0KTsKCQlpbnQgZnJhbWVDb3VudCA9IDA7CgkJd2hpbGUgKGF2Y29kZWNfcmVjZWl2ZV9mcmFtZShkZWNvZGVyQ3R4LCBmcmFtZSkgPT0gMCkKCQl7CgkJCWZyYW1lQ291bnQrKzsKCQl9CgkJcHJpbnRmKCJhdmNvZGVjX3NlbmRfcGFja2V0ICVkIGZyYW1lQ291bnQgPSAlZFxuIiwgcmV0LCBmcmFtZUNvdW50KTsKCX0KCWF2X2ZyYW1lX2ZyZWUoJmZyYW1lKTsKCWF2Y29kZWNfY2xvc2UoZGVjb2RlckN0eCk7CgoJLy9UZXN0KCk7CglyZXR1cm4gMDsKfQoK
